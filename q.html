<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>問題画面 - Quiz</title>
</head>
<body>

<header>
    <h1>Quiz</h1>
</header>

<main>
    <section>
        <h2 v-show="num">第{{num}}問</h2>
        <p>{{quiz}}</p>
        <ol>
           <li v-repeat="ex">{{$value}}</li>
        </ol>
    </section>
    <!-- <time>あと8秒</time> -->
    <button id="btn_next" v-on="click: changeQ()">Next</button>
</main>

<footer>©MeHerBu</footer>

<script src="http://code.jquery.com/jquery-2.1.3.min.js"></script>
<script src='https://cdn.mlkcca.com/v2.0.0/milkcocoa.js'></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/vue/0.10.5/vue.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>

<script>
var milkcocoa = new MilkCocoa('maxi9ffclh3.mlkcca.com');
var ds = milkcocoa.dataStore('quiz');
var $btn_next = $('#btn_next');
var n = 0;


// --------------------------------------------------------
// QA JSON
// --------------------------------------------------------
var qaJson =
{
    "q1": {
        "type" : "image",
        "question" : "HTMLの最新バージョンは？",
        "correct" : "a3",
        "answer" : {
            "a1" : "HTML2",
            "a2" : "HTML4",
            "a3" : "HTML5",
            "a4" : "HTML7"
        }
    },
    "q2": {
        "type" : "text",
        "question" : "CSSの最新バージョンは？",
        "correct" : "a3",
        "answer" : {
            "a1" : "CSS2",
            "a2" : "CSS3",
            "a3" : "CSS5",
            "a4" : "CSS10"
        }
    },
    "q3": {
        "type" : "text",
        "question" : "ECMAScriptの最新バージョンは？",
        "correct" : "a4",
        "answer" : {
            "a1" : "ECMAScript 3",
            "a2" : "ECMAScript 4",
            "a3" : "ECMAScript 5",
            "a4" : "ECMAScript 6"
        }
    }
}

// 問題数を取得
var qNum = 0;
for(var i in qaJson){ qNum++; }


// --------------------------------------------------------
// View
// --------------------------------------------------------
var vue = new Vue({
    el: 'main',
    data: {
        keyword: '',
        num: '',
        quiz: '',
        ex: ''
    },
    methods:{
        // 問題を切り替える処理
        changeQ: function(){
            var that = this;

            // 次の問題をデータバインド
            if(n < qNum) {
                that.num = ++n;
                that.quiz = qaJson['q' + that.num].question;
                that.ex = _.values(qaJson['q' + that.num].answer);
            } else if(n == qNum) {
                // 最後の問題になったら、NextボタンをOFFにする
                $btn_next.attr('disabled', 'disabled');
            }
        }
    }
});


// --------------------------------------------------------
// Ready
// --------------------------------------------------------
// 初回データ取得・セット
vue.changeQ();


</script>

</body>
</html>